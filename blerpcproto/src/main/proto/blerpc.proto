syntax = "proto3";

option java_package = "com.blerpc.proto";
option java_multiple_files = true;
option optimize_for = CODE_SIZE;
option java_generic_services = true;

// A proto part of the BLE RPC library.
package com.blerpc;

import "google/protobuf/descriptor.proto";

// An interaction type with the characteristic.
// A method can interact with a characteristic in three ways: it can write to it, read from it and
// subscribe to it's updates.
enum MethodType {
    // Unknown method type.
    UNKNOWN = 0;
    // A method with this type is allowed to write to a characteristic.
    WRITE = 1;
    // A method with this type is allowed to read the value of a characteristic.
    READ = 2;
    // A method with this type is allowed to subscribe to a characteristic's updates.
    SUBSCRIBE = 3;
}

// BLE characteristic data.
message BleCharacteristicRule {
    // Characteristic UUID.
    string uuid = 1;
    // Descriptor UUID.
    string descriptor_uuid = 3;
    // The method's interaction type with the characteristic.
    MethodType type = 2;
}

message BleServiceRule {
    // Service UUID.
    string uuid = 1;
}

// Desribes byte size of message.
message BytesSize {
    // Size of message in bytes.
    int32 message_size_bytes = 1;
}

// Desribes bytes range that field holds in message.
message BytesRange {
    // The beginning index, inclusive.
    int32 from_byte = 1;
    // The ending index, exclusive.
    int32 to_byte = 2;
}

// Add `field` fiels option for attaching description of field bytes range.
extend google.protobuf.FieldOptions {
    BytesRange field = 82595722;
}

// Add `message` message option for attaching description of message byte size.
extend google.protobuf.MessageOptions {
    BytesSize message = 82595723;
}

// Add `characteristic` method option for attaching the method to a BLE characteristic.
extend google.protobuf.MethodOptions {
    BleCharacteristicRule characteristic = 82595724;
}

// Add `service` service option for attaching the service to a BLE service.
extend google.protobuf.ServiceOptions {
    BleServiceRule service = 82595725;
}
